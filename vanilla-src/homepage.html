<!DOCTYPE HTML>
<html lang="en">

<head>
    <title>Home</title>
    <meta charset="utf-8">
<<<<<<< HEAD
    <script src="schedule.js" type="text/javascript"></script>
=======
    <script src="hideInputTab.js"></script>
>>>>>>> da6c69f36e495b519b7d0f8774b7345ccff9af07
    <style>
        body {
            text-align: center;
            margin: 7% 0 2% 00;
            background-color: white;
            color: #222;
        }

        .logo {
            border-radius: 50%;
            border: 2px solid black;
            background-color: #42b1b1;
            padding: 2rem 2rem 2rem 2rem;
        }

        #recordTable {
            border-collapse: collapse;
            text-align: left;
            font-size: 2.5rem;
            width: 100%;
            margin-top: 5rem;
        }

        #recordTable tr {
            padding: 0 2rem 0 2rem;
            height: 7rem;
        }

        #recordTable tr :nth-child(odd) {
            text-align: left;
            padding-left: 1rem;
            width: 30%;
        }

        /* Games Table*/

        .gamesTable {
            border-collapse: collapse;
            width: 100%;
            border: 0;
        }

        .gamesTable td {
            width: 33.3%;
            padding-top: 2rem;
        }

        .gamesTable img {
            width: 150px;
            height: 200px;
        }

        .gamesTable span {
            display: block;
        }

        .gamesTable h5 {

            font-size: 2rem;
        }

        #upcomingGamesTable tr:hover {
            background-color: orange;
        }

        /* Recent Games Table*/

        #recentGamesTable tr {
            border-bottom: 0.1rem solid #aaa;
            padding-top: 1rem;
        }

        #recentGamesTable tr:hover {
            background-color: orange;
        }

        .recentMiddleCell {
            font-size: 4rem;
        }

        .recentMiddleCellBottom {
            margin-top: 3rem;
        }

        #scoreCell {
            font-size: 4rem;
        }

        #timeCell {
            margin-top: 3rem;
            font-size: 4rem;
        }

        h3 {
            overflow: hidden;
            text-align: center;
            font-size: 3rem;
            margin-bottom: 2rem;
        }

        h3:before,
        h3:after {
            background-color: #000;
            content: "";
            display: inline-block;
            height: 1px;
            position: relative;
            vertical-align: middle;
            width: 50%;
        }

        h3:before {
            right: 0.5em;
            margin-left: -50%;
        }

        h3:after {
            left: 0.5em;
            margin-right: -50%;
        }

        li>a {
            font-size: 2rem;
        }

        #menuTabs {
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        .nav {
            display: block;
            padding-left: 0;
            margin-bottom: 0;
            list-style: none;
        }

        .nav:before,
        .nav:after {
            display: table;
            content: " ";
        }

        .nav:after
            {
            clear: both;
        }

        .nav>li {
            position: relative;
            display: block;
        }

        .nav>li>a {
            position: relative;
            display: block;
            text-decoration: none;
            font-size: 3rem;
            padding: 10px 15px;
        }

        .nav>li>a:hover,
        .nav>li>a:focus {
            text-decoration: none;
            background-color: #eee;
        }

        .nav-pills>li {
            float: left;
        }

        .nav-pills>li>a {
            border-radius: 4px;
        }

        .nav-pills>li+li {
            margin-left: 2px;
        }

        .nav-pills>li.active>a,
        .nav-pills>li.active>a:hover,
        .nav-pills>li.active>a:focus {
            color: #fff;
            background-color: #337ab7;
        }

        .nav-justified {
            width: 100%;
        }

        .nav-justified>li {
            display: table-cell;
            width: 1%;
            float: none;
        }

        .nav-justified>li>a {
            margin-bottom: 5px;
            text-align: center;
        }
    </style>

    <!-- Tabs Styles -->
    <style>
        li>a {
            font-size: 2rem;
        }

        #menuTabs {
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
    </style>
</head>

<body>

    <!-- Logo -->
    <section>
        <img src="LAGalaxy.svg" alt="Team Logo" class="logo">
    </section>
    <section>
        <ul id="menuTabs" class="nav nav-pills nav-justified">
            <li class="active">
                <a data-toggle="pill">Home</a>
            </li>
            <li>
                <a data-toggle="pill" href="schedule_upcoming.html">Schedule</a>
            </li>
            <li>
                <a data-toggle="pill" href="roster_vanilla.html">Roster</a>
            </li>
            <li class="inputTab">
                <a data-toggle="pill" href="input_stats_vanilla.html">Input</a>
            </li>
            <li>
                <a data-toggle="pill" href="account_settings.html">Settings</a>
            </li>
        </ul>
    </section>
        <section>   
        <h3>Current Record</h3>
        <table id="recordTable">
        </table>
        <template id="recordTemplate">
            <tr>
                <td>Team Record:</td>
                <td id="teamRecordData"></td>
                <td>Goals For:</td>
                <td id="goalsForData"></td>
            </tr>
        </template>
        <template id="standingsTemplate">
            <tr>
                <td>Team Standing:</td>
                <td id="teamStandingData">1st</td>
                <td>Goals Against:</td>
                <td id="goalsAgainstData"></td>
            </tr>
        </template>
    </section>
    <section>
    <h3>Upcoming/Current Game</h3>
    <table id="upcomingGamesTable" class="gamesTable">
    </table>
    <template id="upcomingGameTemplate">
        <tr onclick="viewGame(this.getAttribute('data-index'), 'upcoming')">
            <td>
                <h5>Team Aztecs</h5>
            </td>
            <td>
                <span id="scoreCell"></span>
                <!-- Can't really implement now
                <br>
                <span id="timeCell"></span>-->
            </td>
            <td>
                <h5></h5>
            </td>
        </tr>
    </template>
    </section>
    <section>
        <h3>Recent Games</h3>
        <table id="recentGamesTable" class="gamesTable">
        </table>
        <template id="recentGameTemplate">
            <tr onclick="viewGame(this.getAttribute('data-index'), 'previous')">
                <td>
                    <h5>Team Aztecs</h5>
                </td>
                <td>
                    <span class="recentMiddleCell"></span>
                    <br>
                    <span class="recentMiddleCell recentMiddleCellBottom"></span>
                </td>
                <td>
                    <h5></h5>
                </td>
            </tr>
        </template>
    </section>
    <template id="emptyTemplate">
        <tr>
            <td></td>
        </tr>
    </template>
    <script>
        hideInputTab();
        populateGames();
        populateTeamStats();

        function populateGames() {
            var upcomingEventList = localStorage.getItem('upcomingList');
            if (upcomingEventList == undefined) {
                putUpcomingGame([]);
            }
            else {
                upcomingEventList = JSON.parse(upcomingEventList);
                upcomingEventList.sort(function (a,b) {
                    if (Date.parse(a.date) < Date.parse(b.date)) {
                        return -1;
                    }
                    if (Date.parse(a.date) > Date.parse(b.date)) {
                        return 1;
                    }
                    if (a.time < b.time) {
                        return -1;
                    }
                    if (a.time > b.time) {
                        return 1;
                    }
                    return 0;
                });
                updateSchedule(upcomingEventList); 
                putUpcomingGame(upcomingEventList);
            }

            var previousEventList = localStorage.getItem('previousList');
            if (previousEventList == undefined) {
                putRecentGame([]);
            }
            else {
                previousEventList = JSON.parse(previousEventList);
                previousEventList.sort(function (a,b) {
                    if (Date.parse(a.date) < Date.parse(b.date)) {
                        return 1;
                    }
                    if (Date.parse(a.date) > Date.parse(b.date)) {
                        return -1;
                    }
                    if (a.time < b.time) {
                        return 1;
                    }
                    if (a.time > b.time) {
                        return -1;
                    }
                    return 0;
                });
                putRecentGame(previousEventList);
            }
        }

        function populateTeamStats() {
            var previousEventList = localStorage.getItem('previousList');
            var wins = 0;
            var losses = 0;
            var ties = 0;
            var goalsFor = 0;
            var goalsAgainst = 0;
            var recordTable = document.querySelector('#recordTable');
            if (previousEventList != undefined) {
                previousEventList = JSON.parse(previousEventList);
                for (var i = 0; i < previousEventList.length; i++) {
                    var pastEvent = previousEventList[i];
                    if (pastEvent.type == 'Game' && pastEvent.valid == '1') {
                        var ownGoals = parseInt(pastEvent.gameStats.goals);
                        goalsFor += ownGoals;
                        var oppGoals = parseInt(pastEvent.gameStats.oppGoals);
                        goalsAgainst += oppGoals;
                        if (ownGoals > oppGoals) {
                            wins++;
                        }
                        else if (ownGoals < oppGoals) {
                            losses++;
                        }
                        else {
                            ties++;
                        }
                    }
                }
            }
            var record = document.querySelector('#recordTemplate');
            var recordContent = record.content;
            recordContent.querySelector('#teamRecordData').textContent = wins + 'W - ' + losses + 'L - ' + ties + 'T';
            recordContent.querySelector('#goalsForData').textContent = goalsFor;
            var recordClone = document.importNode(recordContent, true);
            recordTable.appendChild(recordClone);

            var standings = document.getElementById('standingsTemplate');
            var standingsContent = standings.content;
            standingsContent.getElementById('goalsAgainstData').textContent = goalsAgainst;
            var standingsClone = document.importNode(standingsContent, true);
            recordTable.appendChild(standingsClone);

        }

        function putUpcomingGame(eventList) {
            var gamesCount = -1;
            for (var i = 0; i < eventList.length; i++) {
                if (eventList[i].type == 'Game' && eventList[i].valid == '1') {
                    gamesCount = i;
                    break;
                }
            }
            var upcomingTable = document.querySelector('#upcomingGamesTable');
            if (gamesCount < 0) {
                var emptyMessage = document.querySelector('#emptyTemplate');
                var td = emptyMessage.content.querySelector('td');
                td.textContent = 'There are no upcoming games right now';
                td.style.fontSize = '3rem';
                var gameClone = document.importNode(emptyMessage.content, true);
            }
            else {
                var upcomingGameT = document.querySelector('#upcomingGameTemplate');
                var upcomingGameContent = upcomingGameT.content;
                upcomingGameContent.children[0].setAttribute('data-index', gamesCount);

                var score = upcomingGameContent.querySelector('#scoreCell');
                var upcomingGame = eventList[gamesCount];
                score.textContent = upcomingGame.gameStats.goals + ' - ' + upcomingGame.gameStats.oppGoals;

                var opp = upcomingGameContent.querySelectorAll('h5')[1];
                opp.textContent = upcomingGame.opponent;

                var gameClone = document.importNode(upcomingGameContent, true);
            }
            upcomingTable.appendChild(gameClone);
        }

        function putRecentGame(eventList) {
            var gamesCount = 0;
            for (var i = 0; i < eventList.length; i++) {
                if (eventList[i].type == 'Game' && eventList[i].valid == '1') {
                    gamesCount++;
                }
            }

            var recentTable = document.querySelector('#recentGamesTable');
            if (gamesCount == 0) {
                var emptyMessage = document.querySelector('#emptyTemplate');
                var td = emptyMessage.content.querySelector('td');
                td.textContent = 'There are no recent games right now';
                td.style.fontSize = '3rem';
                var gameClone = document.importNode(emptyMessage.content, true);
                recentTable.appendChild(gameClone);
                recentTable.children[0].style.borderBottom = 'none';
            }
            else {
                gamesCount = 0;
                for (var i = 0; i < eventList.length; i++) {
                    if (gamesCount == 2) {
                        return 0;
                    }
                    var pastEvent = eventList[i];
                    if (pastEvent.type == 'Game' && pastEvent.valid == '1') {
                        var recentGame = document.querySelector('#recentGameTemplate');
                        var recentGameContent = recentGame.content;
                        recentGameContent.children[0].setAttribute('data-index', i);
                        
                        var gameInfo = recentGameContent.querySelectorAll('.recentMiddleCell');
                        gameInfo[0].textContent = pastEvent.gameStats.goals + ' - ' + pastEvent.gameStats.oppGoals;
                        var ownGoals = parseInt(pastEvent.gameStats.goals);
                        var oppGoals = parseInt(pastEvent.gameStats.oppGoals);
                        if (ownGoals > oppGoals) {
                            gameInfo[1].textContent = 'W';
                        }
                        else if (ownGoals < oppGoals) {
                            gameInfo[1].textContent = 'L';
                        }
                        else {
                            gameInfo[1].textContent = 'T';
                        }

                        var opp = recentGameContent.querySelectorAll('h5')[1];
                        opp.textContent = pastEvent.opponent;

                        var gameClone = document.importNode(recentGameContent, true);
                        recentTable.appendChild(gameClone);
                        gamesCount++;
                    }
                    
                }
            }

        }
    </script>
</body>
</html>