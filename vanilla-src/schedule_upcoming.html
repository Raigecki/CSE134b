<!DOCTYPE html>
<html lang="en">

<head>
    <title>Current/Upcoming Games</title>
    <meta charset="utf-8">
    <script src="schedule.js" type="text/javascript"></script>
<style>
    html {
        font-size: 10px;
    }

    body {
        text-align: center;
        margin: 5% 5% 5% 5%;
        font-size: 4rem;
    }

    #menuTabs {
        margin-bottom: 2rem;
    }

    .nav {
        display: block;
        padding-left: 0;
        margin-bottom: 0;
        list-style: none;
    }

    .nav:before,
    .nav:after,
    .row:before,
    .row:after,
    .modal-header:before {
        display: table;
        content: " ";
    }

    .nav:after,
    .row:after,
    .modal-header:after {
        clear: both;
    }

    .nav>li {
        position: relative;
        display: block;
    }

    .nav>li>a {
        position: relative;
        display: block;
        text-decoration: none;
        font-size: 3rem;
        padding: 10px 15px;
    }

    .nav>li>a:hover,
    .nav>li>a:focus {
        text-decoration: none;
        background-color: #eee;
    }

    .nav-tabs>li.active>a,
    .nav-tabs>li.active>a:hover,
    .nav-tabs>li.active>a:focus {
        color: #555;
        cursor: default;
        background-color: #fff;
        border: 1px solid #ddd;
        border-bottom-color: transparent;
    }

    .nav-tabs>li>a:hover {
        border-color: #eee #eee #ddd;
    }

    .nav-tabs {
        border-bottom: 1px solid #ddd;
    }

    .nav-tabs>li {
        float: left;
        margin-bottom: -1px;
    }

    .nav-tabs>li>a {
        margin-right: 2px;
        line-height: 1.42857143;
        border: 1px solid transparent;
        border-radius: 4px 4px 0 0;
    }

    .nav-pills>li {
            float: left;
        }

        .nav-pills>li>a {
            border-radius: 4px;
        }

        .nav-pills>li+li {
            margin-left: 2px;
        }

        .nav-pills>li.active>a,
        .nav-pills>li.active>a:hover,
        .nav-pills>li.active>a:focus {
            color: #fff;
            background-color: #337ab7;
        }

        .nav-justified {
            width: 100%;
        }

        .nav-justified>li {
            display: table-cell;
            width: 1%;
            float: none;
        }

        .nav-justified>li>a {
            margin-bottom: 5px;
            text-align: center;
        }

    h2 {
        margin-bottom: 2rem;
        font-size: 6rem;
    }

    ul li {
        width: 50%;
    }

    div p {
        font-size: 2.5rem;
    }

    p {
        orphans: 3;
        widows: 3;
        margin: 0 0 10px;
    }

    #removeEventModal p {
        font-size: 4rem;
    }

    .col-xs-3 p:nth-child(1) {
        margin-bottom: 5rem;
    }

    .text-left {
        text-align: left;
    }

    .text-right {
        text-align: right;
    }

    input,
    select {
        height: 8rem;
        font-size: 4rem;
        margin-bottom: 2rem;
        display: block;
        width: 100%;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 4px;
        z-index: 2;
    }

    .well {
        margin-top: 2rem;
        min-height: 20px;
        padding: 19px;
        margin-bottom: 20px;
        background-color: #f5f5f5;
        border: 1px solid #e3e3e3;
        border-radius: 4px;
    }

    .row {
        margin-right: -15px;
        margin-left: -15px;
    }

    .col-xs-3,
    .col-xs-4,
    .col-xs-6,
    .col-xs-6c,
    .col-xs-btn {
        position: relative;
        min-height: 1px;
        float: left;
        padding-left: 15px;
        padding-right: 15px;
    }

    .col-xs-3 {
        width: 20%;
    }

    .col-xs-4 {
        width: 33.33333333333%;
    }

    .col-xs-6 {
        width: 50%;
    }

    .col-xs-6c {
        width: 45%;
    }

    .col-xs-btn {
        width: 10%;
    }

    .manageButtons {
        overflow: hidden;
        text-overflow: ellipsis;
        display: inline-block;
        padding: 6px 12px;
        margin-bottom: 0;
        font-weight: normal;
        line-height: 1.42857143;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        border: 1px solid transparent;
        border-radius: 4px;
        position: relative;
    }

    .btn {
        overflow: hidden;
        text-overflow: ellipsis;
        display: inline-block;
        padding: 6px 12px;
        margin-bottom: 0;
        font-weight: normal;
        line-height: 1.42857143;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        border: 1px solid transparent;
        border-radius: 4px;
        position: relative;
        width: 100%;
        height: 10rem;
        font-size: 5rem;
    }

    .btn-success {
        color: #fff;
        background-color: #5cb85c;
        border-color: #4cae4c;
    }

    .btn-info {
        color: #fff;
        background-color: #5bc0de;
        border-color: #46b8da;
    }

    .btn-danger {
        color: #fff;
        background-color: #d9534f;
        border-color: #d43f3a;
    }

    #addEvent,
    #removeEvent {
        font-size: 3rem;
    }

    #schedule_addButton {
        margin-top: 2rem;
    }

    #gamesList_delete option {
        font-size: 2rem;
    }

    * {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }

    *:before,
    *:after {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }

    .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
        line-height: 100%;
        overflow: auto;
        background-color: rgb(0, 0, 0);
        background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
        position: relative;
        background-color: #fefefe;
        border-radius: 10px;
        border: 1px solid #888;
        width: 80%;
        margin: 10%;
        vertical-align: middle;
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        -webkit-animation-name: animatetop;
        -webkit-animation-duration: 0.5s;
        animation-name: animatetop;
        animation-duration: 0.5s
    }

    .modal-header {
        border-radius: 10px 10px 0px 0px;
        padding: 4px;
        background-color: #42b1b1;
        text-align: center;
        color: white;
        height: 10rem;
        font-size: 4.5rem;
        padding: 1rem 1rem 1rem 2rem;
    }

    .modal-body {
        padding: 4%;
        position: relative;
        text-align: center;
    }

    .modal label {
        display: block;
        text-align: left;
    }

    .modal-header>span:nth-child(1) {
        display: inline-block;
        margin-top: 1.5rem;
    }

    /* The Close Button */

    .close {
        color: white;
        float: right;
        font-size: 6rem;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
    }

    /* Add Animation */
    @keyframes animatetop {
        from {
            top: -300px;
            opacity: 0
        }
        to {
            top: 0;
            opacity: 1
        }
    }
</style>
</head>
<body>
        <ul id="menuTabs" class="nav nav-pills nav-justified">
                <li>
                    <a data-toggle="pill" href="homepage.html">Home</a>
                </li>
                <li class="active">
                    <a data-toggle="pill">Schedule</a>
                </li>
                <li>
                    <a data-toggle="pill" href="roster_vanilla.html">Roster</a>
                </li>
                <li>
                    <a data-toggle="pill" href="input_stats_vanilla.html">Input</a>
                </li>
                <li>
                    <a data-toggle="pill" href="account_settings.html">Settings</a>
                </li>
            </ul>
    <ul class="nav nav-tabs">
        <li class="active">
            <a data-toggle="tab" href="">Ongoing/Upcoming</a>
        </li>
        <li>
            <a data-toggle="tab" href="schedule_previous.html">Previous</a>
        </li>
    </ul>
    <div id="schedule_addButton" class="row">
        <button type="button" id="addEvent" class="btn btn-success" onclick="displayAddEvent()">Add Event</button>
    </div>
    <template id="gameTemplate">
        <div class="well row" onclick="viewGame(this.getAttribute('data-index'), 'upcoming')">
            <div class="col-xs-3 teamInfo">
                <p>Team Aztecs</p>
                <p></p>
            </div>
            <div class="col-xs-6 gameInfo">
                <p></p>
                <p>vs</p>
                <p></p>
            </div>
            <div class="col-xs-3 oppInfo">
                <p></p>
                <p></p>
            </div>
            <div class="col-xs-btn">
                <button type="button" class="btn-info manageButtons" onclick="event.stopPropagation(); updateEvent(this.parentNode.parentNode.getAttribute('data-index'))">Edit</button>
                <button type="button" class="btn-danger manageButtons" onclick="event.stopPropagation(); removeEvent(this.parentNode.parentNode.getAttribute('data-index'))">Remove</button>  
            </div>
        </div>
    </template>
    <template id="practiceTemplate">
        <div class="well row">
            <div class="col-xs-6c practiceTime">
                <p>Practice</p>
                <p></p>
            </div>
            <div class="col-xs-6c practiceLoc">
                <p>Location:</p>
                <p></p>
            </div>
            <div class="col-xs-btn">
                <button type="button" class="btn-info manageButtons" onclick="updateEvent(this.parentNode.parentNode.getAttribute('data-index'))">Edit</button>
                <button type="button" class="btn-danger manageButtons" onclick="removeEvent(this.parentNode.parentNode.getAttribute('data-index'))">Remove</button>  
            </div>           
        </div>
    </template>
    <!-- Add Event Modal -->
    <div id="addEventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span>Add Event</span>
                <span id="closeAddEvent" class="close">&times;</span>
            </div>
            <div id="addBody" class="modal-body">

                <form id="addEventForm" method="POST" onsubmit="addEvent();">
                    <label for="eventType">Select Type of Event:</label>
                    <select id="eventType" name="eventType" form="addEventForm" required onchange="changeAddInfo(this)">
                        <option value="Game">Game</option>
                        <option value="Practice">Practice</option>
                    </select>
                    <div id="opponentContainer">
                        <label for="addGame_opponent">Opponent:</label>
                        <input type="text" name="addGame_opponent" required id="addGame_opponent" minlength="1">
                    </div>
                    <label for="addEvent_date">Date:</label>
                    <input type="date" name="addEvent_date" required id="addEvent_date">
                    <label for="addEvent_time">Time:</label>
                    <input type="time" name="addEvent_time" required id="addEvent_time">
                    <div id="statusContainer">
                        <label for="homeaway_status">Home/Away:</label>
                        <select name="homeaway_status" required id="homeaway_status">
                            <option value="Home">Home</option>
                            <option value="Away">Away</option>
                        </select>
                    </div>
                    <label for="addEvent_loc">Location:</label>
                    <input type="text" name="addEvent_loc" required id="addEvent_loc" minlength="1">
                    <label for="addEvent_city">City:</label>
                    <input type="text" name="addEvent_city" required id="addEvent_city" minlength="1">
                    <input type="submit" id="addEventSubmit" name="addEventSubmit" class="btn btn-success" value="Create Event">
                </form>
            </div>
        </div>
    </div>
    <!-- Update Event Modal -->
    <div id="updateEventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span>Update Event</span>
                <span id="closeUpdateEvent" class="close">&times;</span>
            </div>
            <div id="updateBody" class="modal-body">

                <form id="updateEventForm" method="POST">
                    <label for="updateEventType"></label>
                    <input type="text" name="updateEventType" id="updateEventType" disabled>
                    <div id="updateOpponentContainer">
                        <label for="updateGame_opponent">Opponent:</label>
                        <input type="text" name="updateGame_opponent" required id="updateGame_opponent" minlength="1">
                    </div>
                    <label for="updateEvent_date">Date:</label>
                    <input type="date" name="updateEvent_date" required id="updateEvent_date">
                    <label for="updateEvent_time">Time:</label>
                    <input type="time" name="updateEvent_time" required id="updateEvent_time">
                    <div id="updateStatusContainer">
                        <label for="updateHomeaway_status">Home/Away:</label>
                        <select name="updateHomeaway_status" required id="updateHomeaway_status">
                            <option value="Home">Home</option>
                            <option value="Away">Away</option>
                        </select>
                    </div>
                    <label for="updateEvent_loc">Location:</label>
                    <input type="text" name="updateEvent_loc" required id="updateEvent_loc" minlength="1">
                    <label for="updateEvent_city">City:</label>
                    <input type="text" name="updateEvent_city" required id="updateEvent_city" minlength="1">
                    <input type="submit" id="updateEventSubmit" name="updateEventSubmit" class="btn btn-success" value="Update Event">
                </form>
            </div>
        </div>
    </div>
    <!-- Delete Event Modal -->
    <div id="removeEventModal" class="modal">
        <div class="modal-content">
            <div class="modal-body">
                <p>Are you sure you want to remove this event?</p>
            </div>
            <div class="row">
                <div class="col-xs-6 text-left">
                    <button type="button" id="removeConfirm" class="btn btn-danger">Yes, Remove</button>
                </div>
                <div class="col-xs-6 text-right">
                    <button type="button" id="removeCancel" class="btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        checkUserType();
        showSchedule();
        function checkUserType() {
            var currUser = localStorage.getItem('currentUser');
            if (currUser == undefined || JSON.parse(currUser).type != 'Coach') {
                document.getElementById('schedule_addButton').style.display = 'none';
            }
        }

        function changeAddInfo(dropdown) {
            var opponentInfo = document.querySelector('#opponentContainer');
            var statusInfo = document.querySelector('#statusContainer');
            if (dropdown.value == 'Practice') {
                opponentInfo.style.display = 'none';
                statusInfo.style.display = 'none';
            }
            else {
                opponentInfo.style.display = 'block';
                statusInfo.style.display = 'block';
            }
        }

        function removeEvent(indexStr) {
            var numIndex = parseInt(indexStr);
            var removeModal = document.querySelector('#removeEventModal');
            var upcomingEventList = JSON.parse(localStorage.getItem('upcomingList'));
            var event = upcomingEventList[numIndex];
            var hour = parseInt(event.time.substr(0, 2));
            var timeHalf = 'AM';
            if (hour > 12) {
                hour = hour % 12;
                timeHalf = 'PM';
            }
            var timeStr = hour.toString() + event.time.substr(2) + ' ' + timeHalf;
            var warningStr = `${event.type}: ${event.date} ` + timeStr + ` at ${event.location}`;
            if (event.type == 'Game') {
                warningStr += ` vs ${event.opponent}`;
            }
            var warningParagraph = document.createElement('p');
            var warningMessage = document.createTextNode(warningStr);
            warningParagraph.appendChild(warningMessage);
            var removeBody = removeModal.querySelector('.modal-body');
            while (removeBody.children.length > 1) {
                removeBody.removeChild(removeBody.lastElementChild);
            }
            removeBody.appendChild(warningParagraph);

            removeModal.querySelector('#removeCancel').onclick = function() {
                var removeModal = document.querySelector('#removeEventModal');
                removeModal.style.display = 'none';
            }

            removeModal.querySelector('#removeConfirm').onclick = function() {
                removeFromList(indexStr);
            }
            
            removeModal.style.display = 'block';
        }

        function removeFromList(indexStr) {
            var numIndex = parseInt(indexStr);
            var upcomingEventList = JSON.parse(localStorage.getItem('upcomingList'));
            upcomingEventList.splice(numIndex, 1);
            localStorage.setItem('upcomingList', JSON.stringify(upcomingEventList));
            location.reload();
        }

        function updateEvent(indexStr) {
            var numIndex = parseInt(indexStr);
            var updateModal = document.querySelector('#updateEventModal');
            var opponentInfo = document.querySelector('#updateOpponentContainer');
            var statusInfo = document.querySelector('#updateStatusContainer');
            var upcomingEventList = JSON.parse(localStorage.getItem('upcomingList'));
            var eventType = upcomingEventList[numIndex].type;
            updateModal.querySelector('#updateEventType').value = eventType;
            if (eventType == 'Game') {
                updateModal.querySelector('#updateGame_opponent').value = upcomingEventList[numIndex].opponent;
                updateModal.querySelector('#updateHomeaway_status').value = upcomingEventList[numIndex].status;
                opponentInfo.style.display = 'block';
                statusInfo.style.display = 'block';
            }
            else {
                opponentInfo.style.display = 'none';
                statusInfo.style.display = 'none';
            }

            updateModal.querySelector('#updateEvent_date').value = upcomingEventList[numIndex].dateVal;
            updateModal.querySelector('#updateEvent_time').value = upcomingEventList[numIndex].time;

            var locationStr = upcomingEventList[numIndex].location.split(', ');
            updateModal.querySelector('#updateEvent_loc').value = locationStr[0];
            updateModal.querySelector('#updateEvent_city').value = locationStr[1];

            updateModal.style.display = 'block';
            updateModal.querySelector('#updateEventForm').onsubmit = function() {
                updateList(indexStr);
            };
        }

        function updateList(indexStr) {
            var numIndex = parseInt(indexStr);
            var updateModal = document.querySelector('#updateEventModal');
            var upcomingEventList = JSON.parse(localStorage.getItem('upcomingList'));
            if (upcomingEventList[numIndex].type == 'Game') {
                upcomingEventList[numIndex].opponent = updateModal.querySelector('#updateGame_opponent').value;
                upcomingEventList[numIndex].status = updateModal.querySelector('#updateHomeaway_status').value;
            }
            var dateValue = updateModal.querySelector('#updateEvent_date').value;
            upcomingEventList[numIndex].dateVal = dateValue;
            upcomingEventList[numIndex].time = updateModal.querySelector('#updateEvent_time').value;

            var dateValTokens = dateValue.toString().split('-');
            var year = parseInt(dateValTokens[0]);
            var month = parseInt(dateValTokens[1]) - 1;
            var day = parseInt(dateValTokens[2]);
            var dateString = new Date(year, month, day, 0, 0, 0, 0).toString();
            var dateTokens = dateString.split(' ');
            var date = dateTokens[1] + ' ' + dateTokens[2] + ', ' + dateTokens[3];
            upcomingEventList[numIndex].date = date;

            //get location
            var location = updateModal.querySelector('#updateEvent_loc').value + ", " + updateModal.querySelector('#updateEvent_city').value;
            upcomingEventList[numIndex].location = location;

            if (checkForDuplicateEvents(upcomingEventList, upcomingEventList[numIndex])) {
                alert('Error: Another event already exists at the same time and date.')
                return 0;
            }

            localStorage.setItem('upcomingList', JSON.stringify(upcomingEventList));
        }

        function showSchedule() {
            var upcomingEventList = localStorage.getItem('upcomingList');
            if (upcomingEventList == undefined) {
                return 0;
            }
            upcomingEventList = JSON.parse(upcomingEventList);
            upcomingEventList.sort(function (a,b) {
                if (Date.parse(a.date) < Date.parse(b.date)) {
                    return -1;
                }
                if (Date.parse(a.date) > Date.parse(b.date)) {
                    return 1;
                }
                if (a.time < b.time) {
                    return -1;
                }
                if (a.time > b.time) {
                    return 1;
                }
                return 0;
            });

            updateSchedule(upcomingEventList); 

            var addModal = document.querySelector('#addEventModal');
            for (var index = 0; index < upcomingEventList.length; index++) {
                var currentEvent = upcomingEventList[index];
                if (currentEvent.type == 'Game') {
                    //get template
                    var eventTemplate = document.querySelector('#gameTemplate');
                    var templateContent = eventTemplate.content;
                    templateContent.children[0].setAttribute('data-index', index);

                    //team info
                    var teamStatus = templateContent.querySelector('.teamInfo p:last-child');
                    teamStatus.textContent = "(" + currentEvent.status + ")";

                    //opponent info
                    var oppStatus = (currentEvent.status == 'Home') ? 'Away' : 'Home';
                    var oppInfo = templateContent.querySelectorAll('.oppInfo p');
                    oppInfo[0].textContent = currentEvent.opponent;
                    oppInfo[1].textContent = "(" + oppStatus + ")";

                    //game info
                    var hour = parseInt(currentEvent.time.substr(0, 2));
                    var timeHalf = 'AM';
                    if (hour > 12) {
                        hour = hour % 12;
                        timeHalf = 'PM';
                    }
                    var timeStr = hour.toString() + currentEvent.time.substr(2) + ' ' + timeHalf;
                    var gameInfo = templateContent.querySelectorAll('.gameInfo p');
                    gameInfo[0].textContent = currentEvent.date + ' ' + timeStr;
                    gameInfo[2].textContent = currentEvent.location;

                    var gameClone = document.importNode(templateContent, true);
                    var mainBody = document.querySelector('body');
                    mainBody.insertBefore(gameClone, addModal);

                }
                else {
                    //get practice template
                    var eventTemplate = document.querySelector('#practiceTemplate');
                    var templateContent = eventTemplate.content;
                    templateContent.children[0].setAttribute('data-index', index);

                    //set date and time
                    var hour = parseInt(currentEvent.time.substr(0, 2));
                    var timeHalf = 'AM';
                    if (hour > 12) {
                        hour = hour % 12;
                        timeHalf = 'PM';
                    }
                    var timeStr = hour.toString() + currentEvent.time.substr(2) + ' ' + timeHalf;
                    var practTime = templateContent.querySelector('.practiceTime p:last-child');
                    practTime.textContent = currentEvent.date + ' ' + timeStr;

                    var practLoc = templateContent.querySelector('.practiceLoc p:last-child');
                    practLoc.textContent = currentEvent.location;

                    //insert
                    var practiceClone = document.importNode(templateContent, true);
                    var mainBody = document.querySelector('body');
                    mainBody.insertBefore(practiceClone, addModal);

                }
            }
        }

        function addEvent() {
            var eventForm = document.querySelector('#addEventForm');
            var eventType = eventForm.querySelector('#eventType').value;
            var addModal = document.querySelector('#addEventModal');
            var objEvent = {};
            objEvent['type'] = eventType;
            if (eventType == 'Game') {
                //teaminfo
                var status = eventForm.querySelector('#homeaway_status').value;
                objEvent['status'] = status;

                objEvent['opponent'] = eventForm.querySelector('#addGame_opponent').value;

                var gameStats = {
                    goals: '0',
                    oppGoals: '0',
                    goalKicks: '0',
                    oppGoalKicks: '0',
                    penaltyKicks: '0',
                    oppPenaltyKicks: '0',
                    cornerKicks: '0',
                    oppCornerKicks: '0',
                    possTime: '0',
                    oppPossTime: '0',
                    steals: '0',
                    oppSteals: '0',
                    saves: '0',
                    oppSaves: '0',
                    fouls: '0',
                    oppFouls: '0',
                    yCards: '0',
                    oppYCards: '0',
                    rCards: '0',
                    oppRCards: '0'
                };
                objEvent['gameStats'] = gameStats; 
            }
            
            //get date and time
            var timeString = eventForm.querySelector('#addEvent_time').value;
            var dateValTokens = eventForm.querySelector('#addEvent_date').value.toString().split('-');
            var year = parseInt(dateValTokens[0]);
            var month = parseInt(dateValTokens[1]) - 1;
            var day = parseInt(dateValTokens[2]);
            var dateString = new Date(year, month, day, 0, 0, 0, 0).toString();
            var dateTokens = dateString.split(' ');
            var date = dateTokens[1] + ' ' + dateTokens[2] + ', ' + dateTokens[3];

            //get location
            var location = eventForm.querySelector('#addEvent_loc').value + ", " + eventForm.querySelector('#addEvent_city').value;
            
            objEvent['date'] = date;
            objEvent['time'] = timeString;
            objEvent['location'] = location;
            objEvent['dateVal'] = eventForm.querySelector('#addEvent_date').value;
            if (checkDateLater(date, timeString)) {
                var upcomingEventList = localStorage.getItem('upcomingList');
                if (upcomingEventList == undefined) {
                    upcomingEventList = [];
                }
                else {
                    upcomingEventList = JSON.parse(upcomingEventList);
                }
                if (checkForDuplicateEvents(upcomingEventList, objEvent)) {
                    alert('Error: Another event already exists at the same time and date.')
                    return 0;
                }
                upcomingEventList.push(objEvent);
                localStorage.setItem('upcomingList', JSON.stringify(upcomingEventList));
            }
            else {
                var previousEventList = localStorage.getItem('previousList');
                if (previousEventList == undefined) {
                    previousEventList = [];
                }
                else {
                    previousEventList = JSON.parse(previousEventList);
                }
                if (checkForDuplicateEvents(previousEventList, objEvent)) {
                    alert('Error: Another event already exists at the same time and date.')
                    return 0;
                }
                previousEventList.push(objEvent);
                localStorage.setItem('previousList', JSON.stringify(previousEventList));
            }
            addModal.style.display = 'none';
            eventForm.reset();
        }

        function checkDateLater(date, time) {
            var todayDate = new Date();
            var currentTime = todayDate.getHours() + ":" + todayDate.getMinutes();
            todayDate.setHours(0,0,0,0);
            if (Date.parse(todayDate.toDateString()) == Date.parse(date)) {
                return currentTime < time;
            }
            else {
                return Date.parse(todayDate.toDateString()) < Date.parse(date);
            }
        }

        function checkForDuplicateEvents(eventList, newEvent) {
            for (var index = 0; index < eventList.length; index++) {
                var event = eventList[index];
                if (event.date == newEvent.date && event.time == newEvent.time) {
                    return true;
                }
            }
            return false;
        }

        function displayAddEvent() {
            var addModal = document.getElementById('addEventModal');
            addModal.style.display = 'block';
        }
        document.getElementById('closeAddEvent').onclick = function () {
            var modal = this.parentNode.parentNode.parentNode;
            modal.style.display = 'none';
            this.parentNode.parentNode.querySelector('#addEventForm').reset();
        }
        document.getElementById('closeUpdateEvent').onclick = function () {
            var modal = this.parentNode.parentNode.parentNode;
            modal.style.display = 'none';
        }
    </script>
</body>
</html>